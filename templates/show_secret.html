<!DOCTYPE html>
<html>
<head>
  <title>Secret Key</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 80px; }
    code {
      font-size: 24px;
      background: #eee;
      padding: 10px 20px;
      border-radius: 8px;
      display: inline-block;
    }
    button {
      margin-top: 20px;
      font-size: 18px;
      padding: 10px 20px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h2>üîê Secure Key for MAC: {{ mac }}</h2>
  <p>‚è±Ô∏è Time left: <strong id="countdown">5:00</strong></p>
<script>
  let remaining = 300; // 5 minutes

  function updateCountdown() {
    const min = Math.floor(remaining / 60);
    const sec = remaining % 60;
    document.getElementById("countdown").innerText =
      `${min}:${sec < 10 ? "0" + sec : sec}`;
    
    if (remaining <= 0) {
      document.getElementById("countdown").innerText = "Expired";
      document.getElementById("secretKey").innerText = "‚õî Secret key expired";
      document.querySelector("button").disabled = true;
      return;
    }

    remaining--;
    setTimeout(updateCountdown, 1000);
  }

  updateCountdown();
</script>

  <code id="secretKey">{{ secret }}</code>

  <br>
  <button onclick="useKey()">Use this key</button>

  <script>
    function useKey() {
      const secret = document.getElementById("secretKey").innerText;
      const mac = "{{ mac }}";

      // Save to sessionStorage (simulating secure client key storage)
      sessionStorage.setItem("secretKey", secret);
      sessionStorage.setItem("mac", mac);

      // Redirect to the portal (index)
      window.location.href = "/";
    }
  </script>
</body>
</html>
